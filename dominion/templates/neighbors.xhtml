{% extends "popup.xhtml" %}
{% block content %}

{% if neighbors %}
   <div>
    <h1>Neighbors</h1>
      <form name="setdiplorelation" 
            id="setdiplorelation"
            onsubmit="return false;"
            method="post" >
        <table>
          <tr><td>Info:</td><td>Country:</td><td>friend</td><td>neutral</td><td>enemy</td><td>goto</td></tr>
          <tr><td colspan="5"><hr width="100%" /></td></tr>
          {% for neighbor in neighbors.object_list %}
          {% ifnotequal neighbor.relation "enemy" %}
          <tr>
              <td><img class="noborder" title="info"
                       id="playerinfo{{neighbor.user.id}}"
                       src="/site_media/infobutton.png"/></td>
              <td style="color: white;">{{ neighbor.user.username }}</td>
              <td><input type="radio"
                         style="font-size:12px;"
                         onclick="$('#neighborsubmit').show();stopprop(event);"
                         name="changestatus-{{neighbor.user.id}}"
                         value="friend"
                         {% ifequal neighbor.relation "friend" %}
                         checked="checked"{% endifequal %}></input></td>
              <td><input type="radio" 
                         onclick="$('#neighborsubmit').show();stopprop(event);"
                         name="changestatus-{{neighbor.user.id}}"
                         value="neutral"
                         {% ifequal neighbor.relation "neutral" %}
                         checked="checked"{% endifequal %}></input></td>
              <td><input type="radio" 
                         onclick="$('#neighborsubmit').show();stopprop(event);"
                         name="changestatus-{{neighbor.user.id}}"
                         value="enemy"
                         {% ifequal neighbor.relation "enemy" %}
                         checked="checked"{% endifequal %}></input></td>
              <td><img src="/site_media/center.png" 
                       class="noborder"
                       onclick="centermap({{neighbor.capital.x}},{{neighbor.capital.y}});"
                       title="center on capital"/></td>
          </tr>
        {% endifnotequal %}
        
        {% ifequal neighbor.relation "enemy" %}
          <tr>
            <td style="color: white;">{{ neighbor.user.username }}</td>
            <td style="color: red; font-size: 20px;" colspan="3">At War</td>
            <td>
              <input 
                type="button" 
                onclick="transienttabs.pushtab('begforpeace{{neighbor.user.id}}', 
                                               'Beg For Peace', '', true);
                         transienttabs.gettaburl('begforpeace{{neighbor.user.id}}', 
                                                 '/peace/begforpeace/{{neighbor.user.id}}/');
                         transienttabs.displaytab('begforpeace{{neighbor.user.id}}');
                         stopprop(event);"
                value="--Beg for Peace--" />
            </td>
            <td><img src="/site_media/center.png" 
                     class="noborder"
                     onclick="centermap({{neighbor.capital.x}},{{neighbor.capital.y}});"
                     title="center on capital"/></td>
          </tr>
        {% endifequal %}
        {% endfor %}
        </table>

      <button style="display:none;" 
              onclick="sendform($('#setdiplorelation')[0],
                       '/politics/changestatus/{{page}}/');"
              id="neighborsubmit"
              width="100%" 
              value="Submit" 
              type="submit">--Submit--</button>


      </form>
      {% if neighbors.has_other_pages %}
      <div>
        <div class="paginator">
        {% if neighbors.has_previous %}
          <a id='prevneighbors' href='#'>prev</a>
        {% endif %}
        {% for pagenum in paginator.page_range %}
        {% ifequal pagenum page %}
          <span style="color:white; font-size:12px;">{{pagenum}}</span>
        {% else %}
          <a id='neighborpage{{pagenum}}' href='#'>{{pagenum}}</a>
        {% endifequal %}
        {% endfor %}
        {% if neighbors.has_next %}
          <a id='nextneighbor' href='#'>next</a>
        {% endif %}
        </div>
      </div>
      {% endif %}
    </div>
  <script>
  {% for neighbor in neighbors.object_list %}
  loadtooltip('#playerinfo{{neighbor.user.id}}',
              '/players/{{neighbor.user.id}}/info/',
              580,'click');
  {% endfor %}


  {% if neighbors.has_previous %}
    $("#prevneighbors").click(function(evt){
      newslider('/politics/neighbors/{{neighbors.previous_age_number}}/', '#neighborslider');
    }); 
  {% endif %}
  {% for pagenum in paginator.page_range %}
    $("#neighborpage{{pagenum}}").click(function(evt){
      newslider('/politics/neighbors/{{pagenum}}/', '#neighborslider');
    }); 
  {% endfor %}
  {% if neighbors.has_next %}
    $("#nextneighbors").click(function(evt){
      newslider('/politics/neighbors/{{neighbors.next_age_number}}/', '#neighborslider');
    }); 
  {% endif %}



  </script>
  {% endif %}
{% endblock %}

