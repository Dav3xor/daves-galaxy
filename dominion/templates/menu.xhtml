{% if title %}
<div class='menutitle'>{{title}}</div>
{% endif %}
<ul class="menu">
  {% for item in items %}
  {% ifequal item.type "item" %}
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="handlemenuitemreq(event, '{{ item.url }}');">
    {{ item.title|safe }}
  </li>
  {% endifequal %}

  {% ifequal item.type "helpitem" %}
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="starthelp(); killmenu();">
    HELP 
  </li>
  {% endifequal %}

  {% ifequal item.type "postitem" %}
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="sendrequest(handleserverresponse, '{{ item.url }}',
                             'POST',{'hi':1});">
    {{ item.title|safe }}
  </li>
  {% endifequal %}

  {% ifequal item.type "line" %}
  <hr width="100%"/> 
  {% endifequal %}

  {% ifequal item.type "header" %}
  <li id="{{ item.id }}" class="menuheader"> 
    {{ item.header }}
  </li>
  {% endifequal %}

  {% ifequal item.type "renameroute" %}
  <li class="menuitem" id="{{ item.id }}"
      onmouseup="killmenu();
                 stringprompt({'title': 'Rename Route', 
                               'headline': 'New Name',
                               'maxlen': 20,
                               'text': '{{ item.route.name }}',
                               'submitfunction': function (stuff, string){
                                 sendrequest(handleserverresponse,
                                             '/routes/{{ item.route.id }}/rename/',
                                             'POST', 
                                             {'name': string})
                               },
                               'cancelfunction': function(){},
                               'submit': 'Rename Route',
                               'cancel': 'Cancel'});">
    RENAME ROUTE  
  </li>
  {% endifequal %}

  {% ifequal item.type "ontoroute" %}
  <li class="menuitem" id="{{ item.id }}"
      onmouseup="var r = {}; 
                 r.route = {{ item.route }};
                 r.leg = 0;
                 ontonamedroute({{ item.fleet }}, r); killmenu();">
    ONTO ROUTE - "{{ item.name }}" 
  </li>
  {% endifequal %}

  {% ifequal item.type "ontocircularroute" %}
  <li class="menuitem" id="{{ item.id }}"
      onmouseup="var r = {}; 
                 r.route = {{ item.route }};
                 r.x = {{ item.x }};
                 r.y = {{ item.y }};
                 ontonamedroute({{ item.fleet }}, r); killmenu();">
    ONTO CIRCULAR ROUTE - "{{ item.name }}" 
  </li>
  {% endifequal %}

  {% ifequal item.type "movefleet" %}
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="buildanother=0;
                 routebuilder.startdirectto('{{ item.fleet }}', 
                                     {{ item.x }}, {{ item.y }})"> 
    MOVE 
  </li>
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="routebuilder.startrouteto('{{ item.fleet }}', 
                                     {{ item.x }}, {{ item.y }});"> 
    ROUTE TO
  </li>
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="routebuilder.startrouteto('{{ item.fleet }}', 
                                     {{ item.x }}, {{ item.y }},true);"> 
    CIRCULAR ROUTE
  </li>
  <li class="menuitem" id="{{ item.id }}" 
      onmouseup="handlemenuitemreq(event, '/fleets/{{ item.fleet }}/onto/');">
    ONTO NAMED ROUTE...
  </li>

  {% endifequal %}
  
  {% ifequal item.type "namedroute" %}
  <li class="menuitem" id="{{ item.id }}"
      onmouseup="routebuilder.startnamedroute('{{ item.planet }}', 
                                     {{ item.x }}, {{ item.y }}, false);"> 
      
    CHART NAMED ROUTE
  </li>
  <li class="menuitem" id="{{ item.id }}"
      onmouseup="routebuilder.startnamedroute('{{ item.planet }}', 
                                     {{ item.x }}, {{ item.y }}, true);"> 
      
    CHART NAMED CIRCULAR ROUTE
  </li>
  {% endifequal %}

  {% ifequal item.type "scrapfleet" %}
  <li class="menuitem" id="{{ item.id }}"
      onmouseup="handlemenuitemreq(event, '/fleets/{{ item.fleet }}/scrap/');">
    SCRAP
  </li>
  {% endifequal %}

  {% endfor %}
</ul>
