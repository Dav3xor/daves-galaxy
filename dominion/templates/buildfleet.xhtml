{% extends "popup.xhtml" %}
{% block content %}

<h1>Build Fleet</h1>
  <form name="messageform1"
        onsubmit="sendform(this,'/planets/{{ planet.id }}/buildfleet/');"
        method="post">
    <table>
      <tr>
        <th class="rowheader">Type</th>
        <th class="rowheader">Info</th>
        {% for commodity in shiptypes.commodities %}
        {# column title for each commodity type #}
        <th class="rowheader" id="col-{{ commodity }}">{{ commodity|capfirst }}</th>
        {% endfor %}
        <th class="rowheader">Ships</th>
      </tr>
      {% for type, requires in shiptypes.types.items %}
      <tr>
        <td title="{{ type }}" id="row-{{ type }}" class="rowheader">
          {{ type|capfirst }}
        </td>
        <td id="info-{{ type }}" title="{{ type }}">
          <img class="noborder" src="/site_media/infobutton.png"/>
        </td>
        {% for name, commodity in requires.items %}  
        {# the number of each commodity required to build a unit... #}
        <td id="required-{{ name }}-{{ type }}" class="cell">{{ commodity }}</td>
        {% endfor %}
        <td>
          <input id="num-{{ type }}" 
                 type="text" 
                 name="num-{{ type }}" 
                 size="3" 
                 onkeyup="changebuildlist('{{ type }}', 0);"
                 value="0" />
        </td>
        <td>
          <input type="button"
                 onclick="changebuildlist('{{ type }}', 1);"
                 value="+" />
          <input type="button" 
                 onclick="changebuildlist('{{ type }}', -1);"
                 value="-" />
        </td>
      </tr>
      {% endfor %}
      <tr>
        <th class="rowheader"/><th class="rowheader"/>
        <th class="rowheader" colspan="{{ shiptypes.commodities|length }}">
          Total Available
        </th>
        <th class="rowheader"/>
      </tr>
      <tr>
        <td/><td/>
        {% for commodity, numavailable in shiptypes.commodities.items %}
        <td class="rowtotal" 
            id="available-{{ commodity }}">
          {{ numavailable }}
        </td>
        {% endfor %}
        <td/>
      </tr>
      <tr>
        <th class="rowheader"/><th class="rowheader"/>
        <th class="rowheader" colspan="{{ shiptypes.commodities|length }}">
          Total Left
        </th>
        <th class="rowheader"><div>Total</div><div>Ships</div></th>
      </tr>
      <tr>
        <td/><td/>
        {% for commodity, numavailable in shiptypes.commodities.items %}
        <td class="rowtotal" 
            id="total-{{ commodity }}">
          {{ numavailable }}
        </td>
        {% endfor %}
        <td id="total-ships" class="total">0</td>
      </tr>
      <tr>
        <td/>
        <td  colspan="5">
          <button onclick="changebuildlist('{{ type }}', -1);"
                  style="display:none;"
                  id="submit-build"
                  type="submit">
            -- Build Fleet --
          </button>
        </td>
        <td colspan="2">
          <button type="button"
                  onclick="killmenu();">
            -- Cancel --
          </button>
        </td>
      </tr>
    </table>
  </form>

{% endblock %}
